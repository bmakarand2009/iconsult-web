/*! iconsult 01-02-2014 version: 1.0.0 
 author: https://twitter.com/MakBkar */

/******** start of sevices.js******/
"use strict";myApp.factory("RestMaster",["$resource","$location","$state","$timeout","$cookieStore","appConstants",function(a,b,c,d,e,f){// return $resource('/FACTURA-T/suppliers/saveSupplier/:id');
var g="uninit",h=(function(){g=e.get("authCode")}(),function(){var b=f.baseUrl+"rest/:entityName/:id?token=:token";return a(b,{entityName:"@entityName",id:"@id.clean",token:"@token"},{update:{method:"PUT"}})});return{updateAuthCode:function(a){g=a},createRecord:function(a,b,d){return h().save({entityName:a,token:g},b,function(){//$location.path(viewUrl);
c.go(d)},function(a){throw"Exception Occured in createRecord() ::"+a.error+a.status})},updateRecord:function(a,b,d,e){return h().update({entityName:a,id:b,token:g,curEntity:d},function(){//$location.path(viewUrl+aId);
c.go(e)})},getRecord:function(a,b){return h().get({entityName:a,id:b,token:g})},listRecords:function(a){return console.log("alert calling listrecords"+g),h().query({entityName:a,token:g})},delRecFromList:function(a,b,c,d){return h().remove({ids:b,entityName:a,token:g},function(){d>0&&c.splice(d,1)})},delRecord:function(a,b,d){return h().remove({entityName:a,ids:b,token:g},function(){//$location.path(listUrl);
c.go(d)},function(a){throw"Exception Occured in delete()"+a.status})},bulkDelete:function(a,b){var c=b.join(",");return h().remove({entityName:a,ids:c,token:g})},delRowFromDataTable:function(a,b,c){return h().remove({ids:b,entityName:a,token:g},function(){d(function(){c.fnClearTable()},300)})}}}]),// variable sharing among controllers
myApp.factory("tableDataService",["appConstants",function(a){var b={bProcessing:!0,bJQueryUI:!0,sPaginationType:"full_numbers",iDisplayLength:5,//this would be the params.max value
// bInfo : true,
bFilter:!0,aoColumns:[{aTargets:["mycol1"],mData:"id",mRender:function(a){return'<span ><input type="checkbox" ng-click="isChkBoxSelected('+a+') " ng-model="checkedRows['+a+']" ></span> '}},{mData:"name",aTargets:["mycol2"],mRender:function(a,b,c){//return  '<a href="'+name+'">' + name  + '</a>'
return'<a ui-sref="Vendors.view({id:'+c.id+'})"><h4>'+a+"</h4></a>                                    <p>"+a+"<span> commision</span></p>          						   <p>Company : {{user.commissionPercentage}} </p>"}}],fnRowCallback:function(a){jQuery("td:eq(0)",a).addClass("aligncenter"),jQuery("td:eq(1),td:eq(2)",a).addClass("avo-light")},oTableTools:{sRowSelect:"multi",aButtons:["select_all","select_none"]},aaData:[]};return{getOTableOptions:function(c){return c==a.vendEntity?b:void 0}}}]),/* LIST SUPPLIERS PAGE */
myApp.controller("RecListController",["$scope","$location","$timeout","RestMaster","entDetails",function(a,b,c,d,e){a.init=function(){a.isSelectAll=!1,a.disabledel=!0,a.records=d.listRecords(e.name)}(),a.deleteRec=function(b,c){var f=confirm("Delete Record with ID-> "+b.id);a.statusMessage="",1==f&&(d.delRecFromList(e.name,b.id,a.records,c),a.statusMessage="Record Successfully Deleted"+b.id)},a.cancelDialog=function(){b.path("/"+e.name.toLowerCase()),b.replace()},a.bulkDelete=function(){var b=[];for(var f in a.records){var g=a.records[f];g.selected&&b.push(g.id)}b.length>0&&(//var listState = entDetails.name.charAt(0).toUpperCase() + entDetails.name.slice(1);
d.bulkDelete(e.name,b,a.records),//timeout to allow hibernate to flush records at backend
c(function(){a.records=d.listRecords(e.name)},1e3),a.statusMessage="Records Deleted Successfully")},a.$watch("isSelectAll",function(){for(var b in a.records)a.records[b].selected=a.isSelectAll;a.disabledel=!a.isSelectAll}),a.isChkBoxSelected=function(b){a.isSelectAll||(a.disabledel=b)},a.isListEmpty=function(){return a.disabledel}}]),/*   VIEW CONTROLLER */
myApp.controller("RecViewController",["$scope","$stateParams","RestMaster","entDetails",function(a,b,c,d){a.record,a.record||(a.record=c.getRecord(d.name,b.id)),a.viewRecord=function(){alert("ViewRecord callled for"+d.name+b.id),a.record=c.getRecord(d.name,b.id)},a.save=function(){//var viewUrl = "/view_supplier/";
var e=d.name+".view";a.status=c.updateRecord(d.name,b.id,a.record,e)},a.delete=function(){var b=d.name;a.status=c.delRecord(d.name,a.record.id,b)}}]),//This service represents the ServierSide Paging of Jquery datatable but this is not upkept
//with the logic and needs to be tested more thorughtly
//servers side has been added though
myApp.controller("ListServerPagingCtrl",["$scope","$location","$timeout","RestMaster","entDetails","$http","$compile",function(a,b,c,d,e,f,g){a.dtable=new Object,//placeholder for the jquery datatable object 
a.options={bProcessing:!0,bServerSide:!0,bJQueryUI:!0,sAjaxSource:"/rest/candidates",sPaginationType:"full_numbers",iDisplayLength:10,//this would be the params.max value
bInfo:!0,bFilter:!0,aoColumns:[{aTargets:["mycol1"],mData:"id",mRender:function(a){return'<span ><input type="checkbox" ng-click="isChkBoxSelected('+a+') " ></span> '}},{mData:"name",aTargets:["mycol2"],mRender:function(a){return'<a href="'+a+'">'+a+"</a>"}},{mData:"id",aTargets:["mycol3"],mRender:function(a){return'  <div class="supplierAction">                                      <a class="iconfa-eye-open" ui-sref="Vendors.view({id:'+a+'})" ></a>                                     <a class="iconfa-edit" ui-sref="Vendors.edit({id:'+a+'})"></a>                                     <a class="iconfa-trash" ng-click="deleteRec('+a+')" data-toggle="modal"></a>                                     </div>'}}],fnRowCallback:function(a){jQuery("td:eq(0)",a).addClass("aligncenter"),jQuery("td:eq(1),td:eq(2),td:eq(3)",a).addClass("avo-light")},oLanguage:{sSearch:"Search all columns:"}},a.options.fnCreatedRow=function(b){g(b)(a)},a.deleteRec=function(b){var c=confirm("Delete Record with ID-> "+b);a.statusMessage="",1==c&&(d.delRowFromDataTable("candidates",b,a.dtable),a.statusMessage="Record Successfully Deleted"+b)},//bulk delete logic
// $scope.init = function(){
//    $scope.isSelectAll = false;
//    $scope.disabledel = true
// }
a.isChkBoxSelected=function(){},a.isListEmpty=function(){return a.disabledel}}]),myApp.controller("BulkRecDeleteCtrl",["$scope","RestMaster","model",function(a,b,c){a.entDetails=c.entDetails,a.selectedItems=c.selectedItems,a.submit=function(c){console.log("entDetails"+a.entDetails.name+"selItems"+a.selectedItems),b.bulkDelete(a.entDetails.name,a.selectedItems).$promise.then(function(){toastr.success("Delete Records Successfully."),//TBD not working
c()})}}]),myApp.controller("ListClientPagingCtrl",["$scope","$location","$timeout","RestMaster","entDetails","tableDataService","$http","$compile","createDialog","genericModules",function(a,b,c,d,e,f,g,h,i,j){a.selectedItems=[],a.checkedRows=[],a.options=f.getOTableOptions(e.name),a.options.fnCreatedRow=function(b){h(b)(a)},a.deleteRec=function(b){var c=confirm("Delete Record with ID-> "+b);a.statusMessage="",1==c&&(d.delRecFromList(e.name,b,a.options.aaData,1),a.statusMessage="Record Successfully Deleted"+b)},//bulk delete logic
a.init=function(){a.isSelectAll=!1,a.disabledel=!0,a.options.aaData=d.listRecords(e.name)}(),a.isChkBoxSelected=function(b){console.log("cehckbox select"+b);var c=!1;for(var d in a.selectedItems){var e=a.selectedItems[d];e==b&&(a.selectedItems.splice(d,1),c=!0)}c||a.selectedItems.push(b),a.isSelectAll||(a.disabledel=a.selectedItems.length>0?!1:!0),console.log("selected items list"+a.selectedItems+"and disabledel val is"+a.disabledel)},a.isListEmpty=function(){return a.disabledel},a.bulkDelete=function(){a.selectedItems.length;i(j.deleteDialog,{id:"deleteVendorDialog",title:j.deleteDialogTitle,backdrop:!0,controller:"BulkRecDeleteCtrl",success:{label:"Delete ",fn:function(){//$scope.billtos.splice(index, 1);
//updateHasBilltos();
console.log("delte needs to be worked on"),//timeout to allow hibernate to flush records at backend
c(function(){a.options.aaData=d.listRecords(e.name),a.isSelectAll=!1,a.processCheckAll()},1e3)}}},{model:{selectedItems:a.selectedItems,entDetails:e}})},a.$watch("searchText",function(a){void 0!=a&&//search only on the column one fo the list
window.oTable.fnFilter(a,1)}),a.$watch("isSelectAll",function(){a.processCheckAll()}),a.processCheckAll=function(){console.log("processCheckAll called"),//var oSettings = window.oTable.fnSettings()
//console.log(oSettings)
//var len = oSettings._iDisplayLength
jQuery.each(a.options.aaData,function(b,c){// jQuery.each(window.oTable.fnSettings().aoData, function( index, value ) {
console.log("value is"+c.id),a.checkedRows[c.id]=a.isSelectAll,a.selectedItems.push(c.id)}),a.disabledel=!a.isSelectAll,//add ids to the selectedItems based on selection
a.isSelectAll||(a.selectedItems=[]),console.log("Selected Checkbox "+a.selectedItems)}}]);var Application=Application||{};Application.Shared=angular.module("iconsult.shared",["fundoo.services","ui.bootstrap"]),Application.Shared.value("genericModules",{deleteDialog:"/shared/generic.delete.html",deleteDialogTitle:"Confirm Delete",dateDialog:"/shared/generic.dateDialog.html"}).value("toastr",window.toastr),Application.Shared.factory("sharedService",["$cookieStore","$http","appConstants",function(a,b,c){return{autoComplete:function(d){var e=c.baseUrl+"geo/findByCityOrZip?q=",f=a.get("authCode"),g=e+d+"&token="+f;return b.get(g)}}}]);
//# sourceMappingURL=web-app/assets/sources.min.js.map